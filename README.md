# üß† Medical Diagnosis ETL Pipeline with Apache Airflow

## üìå –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
- –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
- –≠—Ç–∞–ø—ã –ø–∞–π–ø–ª–∞–π–Ω–∞
- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ª–æ–∫–∞–ª—å–Ω—ã–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º
- –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∏ –∞–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫
- –ò–¥–µ–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è
- –°–∫—Ä–∏–Ω—à–æ—Ç—ã

---

## üéØ –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–°–æ–∑–¥–∞—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã–π ETL-–ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö (–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Ä–∞–∫–∞ –≥—Ä—É–¥–∏), –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤. –ü—Ä–æ–µ–∫—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **Apache Airflow** –∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è –≤ –ø—Ä–æ–¥–∞–∫—à–Ω-—Å—Ä–µ–¥–µ.

---

##‚öôÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- `etl/` ‚Äî –º–æ–¥—É–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏, –æ–±—É—á–µ–Ω–∏—è –∏ –æ—Ü–µ–Ω–∫–∏
- `dags/` ‚Äî DAG Airflow
- `results/` ‚Äî —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã (`model.pkl`, `metrics.json`, –∞—Ä—Ö–∏–≤—ã)
- `logs/` ‚Äî –ª–æ–≥–∏ Airflow
- `.env` ‚Äî –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–≤–∫–ª—é—á–∞—è FERNET_KEY)
- `Dockerfile` + `docker-compose.yml` ‚Äî –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è

### üîÅ –°—Ö–µ–º–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞ (–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è):

```mermaid
graph TD
    A[load_data] --> B[preprocess]
    B --> C[train_model]
    C --> D[evaluate_model]
    D --> E[save_results]
```

---

## üîÑ –û–ø–∏—Å–∞–Ω–∏–µ —à–∞–≥–æ–≤ –ø–∞–π–ø–ª–∞–π–Ω–∞

1. **load_data** ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞ Breast Cancer Wisconsin —Å UCI —á–µ—Ä–µ–∑ `ucimlrepo`
2. **preprocess** ‚Äî –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, train/test split
3. **train_model** ‚Äî –æ–±—É—á–µ–Ω–∏–µ LogisticRegression
4. **evaluate_model** ‚Äî —Ä–∞—Å—á—ë—Ç Accuracy, Precision, Recall, F1
5. **save_results** ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏, –º–µ—Ç—Ä–∏–∫ –∏ –∞—Ä—Ö–∏–≤–∞—Ü–∏—è –ø–æ –¥–∞—Ç–µ

---

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### 1. –ü–æ—Å—Ç—Ä–æ–π –∏ –∑–∞–ø—É—Å—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
```bash
docker compose build
docker compose up -d
```

### 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π Airflow
```bash
docker compose run --rm airflow airflow db init
```

### 3. –°–æ–∑–¥–∞–π –∞–¥–º–∏–Ω–∞
```bash
docker exec -it airflow_pipeline airflow users create `
  --username admin `
  --password admin `
  --firstname airflow `
  --lastname admin `
  --role Admin `
  --email admin@example.com
```

### 4. –ü–µ—Ä–µ–π–¥–∏ –≤ UI
```
http://localhost:8080
```
–õ–æ–≥–∏–Ω: `admin`, –ø–∞—Ä–æ–ª—å: `admin`

---

## üíæ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ**
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `results/`:
  - `model.pkl` ‚Äî —Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –º–æ–¥–µ–ª—å
  - `metrics.json` ‚Äî –º–µ—Ç—Ä–∏–∫–∏
  - `archive/YYYY-MM-DD/` ‚Äî —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç

–§–æ—Ä–º–∞—Ç:
```json
{
   "accuracy": 0.9736842105263158,
   "precision": 0.9761904761904762,
   "recall": 0.9534883720930233,
   "f1_score": 0.9647058823529412
}
```

---

## üõ°Ô∏è –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –í–æ–∑–º–æ–∂–Ω—ã–µ —Å–±–æ–∏ –∏ —á—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:
| –¢–æ—á–∫–∞ —Å–±–æ—è                                | –†–µ—à–µ–Ω–∏–µ                                                    |
|-------------------------------------------|-------------------------------------------------------------|
| –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (`ucimlrepo`)  | –û–±—ë—Ä–Ω—É—Ç –≤ try/except, –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è                           |
| –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –¥–∞–Ω–Ω—ã—Ö             | –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –ª–æ–≥–∏–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –ø–µ—Ä–µ–¥ split                      |
| –ú–æ–¥–µ–ª—å –Ω–µ –æ–±—É—á–∞–µ—Ç—Å—è (–æ—à–∏–±–∫–∞ fit)          | –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ fallback                                     |
| –û—à–∏–±–∫–∞ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏                       | –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—É—Ç–∏ –∏ –ø—Ä–∞–≤ –Ω–∞ –ø–∞–ø–∫—É `results/`                   |
| –ë–∞–∑–∞ –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞                  | –Ø–≤–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ `airflow db init`                            |

### –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏:
- `logging` –≤ –∫–∞–∂–¥–æ–º —à–∞–≥–µ
- Airflow `PythonOperator` —Å retry (–º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å)
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —à–∞–≥–æ–≤ –Ω–∞ **–∞—Ç–æ–º–∞—Ä–Ω—ã–µ** `.py` –º–æ–¥—É–ª–∏
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ task-–∞

---

## üí° –ò–¥–µ–∏ –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è –ø—Ä–æ–µ–∫—Ç–∞

- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google Drive –∏–ª–∏ S3 (boto3, pydrive)
- –ê–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
- –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ Telegram –æ —Å—Ç–∞—Ç—É—Å–µ DAG
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è CI/CD-—Å–±–æ—Ä–∫–∞ —á–µ—Ä–µ–∑ GitHub Actions
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–æ–¥–µ–ª–µ–π –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ –º–µ—Ç—Ä–∏–∫–∞–º

---

## üñºÔ∏è –°–∫—Ä–∏–Ω—à–æ—Ç—ã

![DAG graph view](screenshots/dag_graph.png)
![Task success](screenshots/task_success.png)

(–¥–æ–±–∞–≤—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –ø–∞–ø–∫—É `/screenshots/` –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)

---

## üì¶ –í–µ—Ä—Å–∏—è
- Airflow 2.7.2
- Docker Compose
- Python 3.8+
- scikit-learn, pandas, ucimlrepo

---

¬© 2025 ‚Äî Medical AI Pipeline